<!doctype html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
    />
    <title>The Wedding of Fulan & Fulanah</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700&family=Great+Vibes&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Poppins:wght@300;400;500;600&display=swap"
      rel="stylesheet"
    />
    <!-- Icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- QRCode Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
      :root {
        /* Warna Nuansa Islami & Jawa (Maroon Gelap, Emas, Hijau Tua) */
        --bg-dark: #1a0505;
        --bg-panel: rgba(40, 10, 10, 0.7);
        --gold: #d4af6a;
        --gold-light: #f3e5ab;
        --gold-dim: #8a703e;
        --islamic-green: #0f3d0f;
        --text-main: #f0f0f0;
        --text-muted: #ccc;
        --glass-border: 1px solid rgba(212, 175, 106, 0.3);
        --shadow: 0 15px 35px rgba(0, 0, 0, 0.6);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        outline: none;
        -webkit-tap-highlight-color: transparent;
      }

      html {
        scroll-behavior: smooth;
      }

      body {
        font-family: "Poppins", sans-serif;
        background-color: var(--bg-dark);
        color: var(--text-main);
        overflow-x: hidden;
        line-height: 1.6;
        /* Background Hutan Gelap Mystical */
        background: url("https://images.unsplash.com/photo-1518173946687-a4c8892bbd9f?q=80&w=1920&auto=format&fit=crop")
          no-repeat center center fixed;
        background-size: cover;
      }

      /* Overlay Pola Islam/Jawa */
      body::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle at center, rgba(26, 5, 5, 0.5), rgba(15, 61, 15, 0.9)),
                    url("https://www.transparenttextures.com/patterns/arabesque.png"); /* Pattern Islami */
        z-index: -1;
        pointer-events: none;
      }

      /* Typography */
      h1, h2, h3 {
        font-family: "Cinzel Decorative", serif;
        color: var(--gold);
      }
      .font-script {
        font-family: "Great Vibes", cursive;
        color: var(--gold-light);
      }

      /* Utility */
      .container { max-width: 1000px; margin: 0 auto; padding: 0 20px; position: relative; z-index: 2; }
      .section-padding { padding: 100px 0; }
      .text-center { text-align: center; }
      .hidden { display: none !important; }

      /* --- 3D CARD STYLE --- */
      .card-3d-wrapper { perspective: 1000px; margin-bottom: 30px; }
      .glass-card {
        background: rgba(20, 5, 5, 0.6);
        backdrop-filter: blur(8px);
        -webkit-backdrop-filter: blur(8px);
        border: var(--glass-border);
        border-radius: 15px;
        box-shadow: var(--shadow);
        padding: 30px;
        transition: transform 0.4s ease, box-shadow 0.4s ease;
        transform-style: preserve-3d;
      }
      .glass-card:hover {
        transform: translateY(-10px) rotateX(2deg);
        box-shadow: 0 20px 40px rgba(212, 175, 106, 0.15);
        border-color: var(--gold);
      }

      /* --- COVER OVERLAY --- */
      #cover-overlay {
        position: fixed;
        inset: 0;
        background: url("https://images.unsplash.com/photo-1515934751635-c81c6bc9a2d8?q=80&w=1920&auto=format&fit=crop")
          no-repeat center center/cover;
        z-index: 9999;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        transition: transform 1.2s cubic-bezier(0.77, 0, 0.175, 1);
        overflow: hidden;
      }
      #cover-overlay::before {
        content: "";
        position: absolute;
        inset: 0;
        background: rgba(10, 0, 0, 0.8);
        backdrop-filter: blur(3px);
      }
      #cover-overlay.opened { transform: translateY(-100%); }

      .cover-content {
        position: relative;
        z-index: 2;
        text-align: center;
        padding: 40px;
        border: 2px solid var(--gold);
        background: rgba(0,0,0,0.4);
        border-radius: 15px;
        box-shadow: 0 0 30px rgba(0,0,0,0.8);
        animation: fadeInUp 1.5s ease-out;
      }
      .bismillah-cover {
        font-family: 'Great Vibes', cursive;
        font-size: 2rem;
        color: var(--gold);
        margin-bottom: 20px;
      }
      .cover-couple {
        font-size: 3.5rem;
        margin: 20px 0;
        font-family: "Great Vibes", cursive;
        text-shadow: 0 2px 10px rgba(0,0,0,0.8);
        line-height: 1.1;
      }
      .btn-open {
        background: linear-gradient(45deg, var(--gold), var(--gold-dim));
        color: #2a0505;
        font-family: "Cinzel Decorative", serif;
        font-weight: 700;
        padding: 15px 50px;
        border: none;
        border-radius: 50px;
        font-size: 1.1rem;
        cursor: pointer;
        box-shadow: 0 0 30px rgba(212, 175, 106, 0.6);
        transition: 0.4s;
        display: inline-flex;
        align-items: center;
        gap: 10px;
        text-transform: uppercase;
      }
      .btn-open:hover { transform: scale(1.1); }

      /* --- HERO SECTION --- */
      #hero { min-height: 90vh; display: flex; align-items: center; justify-content: center; text-align: center; position: relative; }
      .hero-names { font-size: 4.5rem; line-height: 1.2; margin: 20px 0; text-shadow: 0 0 30px rgba(212, 175, 106, 0.3); }
      .hero-and { font-size: 2rem; vertical-align: middle; color: var(--gold); display: inline-block; margin: 0 15px; }

      /* --- COUPLE PROFILE --- */
      .couple-wrapper { display: flex; flex-wrap: wrap; justify-content: center; gap: 40px; margin-top: 40px; }
      .couple-card { width: 350px; text-align: center; }
      .photo-frame {
        width: 180px; height: 180px; border-radius: 50%; padding: 5px;
        border: 2px solid var(--gold); margin: 0 auto 20px; position: relative;
      }
      /* Pola Bunga di Sekitar Foto */
      .photo-frame::before, .photo-frame::after {
        content: "âœ¿"; position: absolute; font-size: 2.5rem; color: var(--gold);
      }
      .photo-frame::before { top: -25px; left: -25px; transform: rotate(-45deg); }
      .photo-frame::after { bottom: -25px; right: -25px; transform: rotate(135deg); }
      .photo-frame img { width: 100%; height: 100%; object-fit: cover; border-radius: 50%; border: 3px solid var(--gold-dim); }
      .couple-name { font-size: 2.2rem; margin-bottom: 10px; font-family: "Great Vibes"; }
      .couple-bio { font-size: 0.9rem; color: var(--text-muted); margin-top: 10px; }

      /* --- LOVE STORY (TIMELINE) --- */
      .story-line { position: relative; max-width: 800px; margin: 50px auto; padding: 20px 0; }
      .story-line::before {
        content: ""; position: absolute; top: 0; bottom: 0; left: 50%; width: 2px;
        background: var(--gold-dim); transform: translateX(-50%);
      }
      .story-item { margin-bottom: 40px; position: relative; width: 100%; display: flex; justify-content: center; align-items: center; }
      .story-content { width: 45%; background: rgba(0,0,0,0.5); padding: 20px; border-radius: 10px; border: 1px solid var(--gold-dim); position: relative; }
      .story-item:nth-child(odd) .story-content { margin-right: auto; text-align: right; }
      .story-item:nth-child(even) .story-content { margin-left: auto; text-align: left; }
      .story-dot {
        position: absolute; left: 50%; width: 20px; height: 20px; background: var(--gold);
        border-radius: 50%; transform: translateX(-50%); border: 4px solid #000; box-shadow: 0 0 10px var(--gold);
      }
      .story-year { font-family: "Cinzel Decorative"; color: var(--gold); font-size: 1.2rem; margin-bottom: 5px; display: block; }

      /* --- EVENT DETAILS --- */
      .event-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-top: 50px; }
      .event-card { text-align: center; position: relative; overflow: hidden; }
      .event-icon { font-size: 2.5rem; color: var(--gold); margin-bottom: 20px; }
      .btn-map {
        display: inline-block; margin-top: 15px; padding: 10px 20px; border: 1px solid var(--gold);
        color: var(--gold); text-decoration: none; border-radius: 20px; font-size: 0.9rem; transition: 0.3s;
      }
      .btn-map:hover { background: var(--gold); color: #000; }

      /* --- LIVE STREAMING --- */
      .live-btn-wrapper { text-align: center; margin: 50px 0; }
      .btn-live {
        background: #ff0000; color: white; padding: 15px 40px; border-radius: 50px;
        text-decoration: none; font-weight: bold; box-shadow: 0 0 20px rgba(255, 0, 0, 0.5);
        animation: pulse-red 2s infinite; display: inline-flex; align-items: center; gap: 10px;
      }
      @keyframes pulse-red {
        0% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0.7); }
        70% { box-shadow: 0 0 0 20px rgba(255, 0, 0, 0); }
        100% { box-shadow: 0 0 0 0 rgba(255, 0, 0, 0); }
      }

      /* --- GIFT / ANGPAO --- */
      .gift-card {
        background: linear-gradient(135deg, #3d0c0c, #1a0505); border: 2px solid var(--gold);
        border-radius: 15px; padding: 30px; text-align: center; max-width: 500px; margin: 0 auto; position: relative;
      }
      .gift-card::after {
        content: "WEDDING GIFT"; position: absolute; top: -15px; left: 50%; transform: translateX(-50%);
        background: var(--gold); color: #000; padding: 5px 20px; border-radius: 20px; font-weight: bold; font-size: 0.8rem;
      }
      .bank-name { font-size: 1.5rem; font-weight: bold; margin: 10px 0; }
      .rekening { font-size: 1.5rem; letter-spacing: 2px; color: var(--gold); font-family: 'Cinzel Decorative'; margin-bottom: 20px; }
      .btn-copy {
        background: transparent; border: 1px solid var(--gold); color: var(--gold); padding: 8px 25px;
        border-radius: 5px; cursor: pointer; transition: 0.3s;
      }
      .btn-copy:hover { background: var(--gold); color: #000; }

      /* --- RSVP & FORM --- */
      .rsvp-form { max-width: 600px; margin: 0 auto; }
      .form-group { margin-bottom: 20px; text-align: left; }
      .form-label { display: block; margin-bottom: 8px; color: var(--gold-light); font-size: 0.9rem; }
      .form-input, .form-select, .form-textarea {
        width: 100%; padding: 12px; background: rgba(0,0,0,0.3); border: 1px solid var(--gold-dim);
        border-radius: 5px; color: #fff; font-family: inherit;
      }
      .form-input:focus { border-color: var(--gold); }
      .btn-submit {
        width: 100%; padding: 15px; background: var(--gold); color: #2a0505; border: none; border-radius: 5px;
        font-weight: bold; cursor: pointer; font-size: 1rem; transition: 0.3s;
      }
      .btn-submit:hover { background: #fff; }

      /* --- FOOTER & MUSIC --- */
      footer {
        padding: 40px; text-align: center; background: rgba(0,0,0,0.8); border-top: 2px solid var(--gold-dim);
        font-size: 0.8rem; color: var(--text-muted);
      }
      .music-control {
        position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px;
        background: rgba(212, 175, 106, 0.2); backdrop-filter: blur(5px); border: 2px solid var(--gold);
        border-radius: 50%; display: flex; align-items: center; justify-content: center; color: var(--gold);
        font-size: 1.5rem; cursor: pointer; z-index: 999; animation: rotateMusic 4s linear infinite;
        animation-play-state: paused;
      }
      .music-control.playing { animation-play-state: running; }
      @keyframes rotateMusic { 100% { transform: rotate(360deg); } }
      @keyframes fadeInUp { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: translateY(0); } }

      /* Responsive */
      @media (max-width: 768px) {
        .story-line::before { left: 20px; }
        .story-content { width: 80% !important; margin-left: 50px !important; text-align: left !important; }
        .story-dot { left: 20px; }
        .hero-names { font-size: 3rem; }
        .cover-couple { font-size: 2.5rem; }
        .btn-open { padding: 12px 30px; font-size: 0.9rem; }
      }
    </style>
  </head>

  <!-- 
    PENTING: UBAH SRC DI BAWAH INI DENGAN LINK MP3 ANDA 
    Contoh Link Google Drive: https://drive.google.com/uc?export=view&id=FILE_ID_ANDA
  -->
  <audio id="bg-music" loop>
    <source src="https://cdn.pixabay.com/download/audio/2022/10/25/audio_31c2730e64.mp3?filename=indonesian-traditional-music-126766.mp3" type="audio/mpeg">
  </audio>

  <body>
    <!-- Music Button -->
    <div class="music-control" id="music-btn" onclick="toggleMusic()">
      <i class="fas fa-compact-disc"></i>
    </div>

    <!-- Cover Overlay -->
    <div id="cover-overlay">
      <div class="cover-content">
        <div class="bismillah-cover">Bismillahirrahmanirrahim</div>
        <h3 style="color: #fff; letter-spacing: 2px; margin-bottom: 10px;">Assalamualaikum Warahmatullahi Wabarakatuh</h3>
        <p style="color: #ccc; margin-bottom: 20px;">Tanpa mengurangi rasa hormat, kami bermaksud mengundang Bapak/Ibu/Saudara/i untuk hadir di acara pernikahan putra-putri kami:</p>
        <h1 class="cover-couple">Fulan & Fulanah</h1>
        <div style="font-size: 1.1rem; color: var(--gold); margin-bottom: 30px;">Sabtu, 23 Mei 2026</div>
        
        <button class="btn-open" onclick="openInvitation()">
          <i class="fas fa-envelope-open"></i> Buka Undangan
        </button>
      </div>
    </div>

    <!-- Main Content (Hidden initially) -->
    <main style="display: none;" id="main-content">
      
      <!-- HERO -->
      <section id="hero" class="section-padding">
        <div class="container">
          <h1 class="hero-names reveal-on-scroll">
            Fulan <span class="hero-and">&</span> Fulanah
          </h1>
          <p style="color: var(--gold-light); letter-spacing: 2px;">Maha Suci Allah yang telah menciptakan makhluk-Nya berpasang-pasangan.</p>
        </div>
      </section>

      <!-- PROFIL MEMPELAI -->
      <section id="couple" class="section-padding">
        <div class="container text-center">
          <h2 class="reveal-on-scroll" style="font-size: 2.5rem; margin-bottom: 10px;">Mempelai</h2>
          <p class="reveal-on-scroll" style="margin-bottom: 40px; color: var(--text-muted);">Dengan memohon Rahmat dan Ridho Allah SWT</p>
          
          <div class="couple-wrapper">
            <!-- Pria -->
            <div class="card-3d-wrapper reveal-on-scroll">
              <div class="glass-card couple-card">
                <div class="photo-frame">
                  <img src="https://picsum.photos/seed/groomjawa/300/300" alt="Fulan">
                </div>
                <h3 class="couple-name">Fulan bin Fulan</h3>
                <p class="couple-bio">Putra Pertama</p>
                <p class="couple-bio">Bpk. Fulan & Ibu Fulanah</p>
              </div>
            </div>

            <!-- Wanita -->
            <div class="card-3d-wrapper reveal-on-scroll">
              <div class="glass-card couple-card">
                <div class="photo-frame">
                  <img src="https://picsum.photos/seed/bridejawa/300/300" alt="Fulanah">
                </div>
                <h3 class="couple-name">Fulanah binti Fulan</h3>
                <p class="couple-bio">Putri Kedua</p>
                <p class="couple-bio">Bpk. Fulan & Ibu Fulanah</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- LOVE STORY -->
      <section id="story" class="section-padding" style="background: rgba(0,0,0,0.3);">
        <div class="container text-center">
          <h2 class="reveal-on-scroll" style="font-size: 2.5rem; margin-bottom: 40px;">Kisah Cinta Kami</h2>
          
          <div class="story-line">
            <div class="story-item reveal-on-scroll">
              <div class="story-dot"></div>
              <div class="story-content">
                <span class="story-year">2020</span>
                <h3>Pertemuan Pertama</h3>
                <p>Segala puji bagi Allah SWT yang telah mempertemukan kami di jalan yang lurus.</p>
              </div>
            </div>
            <div class="story-item reveal-on-scroll">
              <div class="story-dot"></div>
              <div class="story-content">
                <span class="story-year">2025</span>
                <h3>Lamaran</h3>
                <p>Dengan restu kedua orang tua, kami memantapkan niat untuk membina rumah tangga.</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- DETAIL ACARA -->
      <section id="event" class="section-padding">
        <div class="container text-center">
          <h2 class="reveal-on-scroll" style="font-size: 2.5rem;">Rangkaian Acara</h2>
          
          <div class="event-grid">
            <!-- Akad -->
            <div class="card-3d-wrapper reveal-on-scroll">
              <div class="glass-card event-card">
                <i class="fas fa-hand-holding-heart event-icon"></i>
                <h3>Akad Nikah</h3>
                <p style="color: var(--gold); font-weight: bold;">08:00 - 10:00 WIB</p>
                <p>Masjid Agung, Yogyakarta</p>
                <a href="https://goo.gl/maps/placeholder" target="_blank" class="btn-map"><i class="fas fa-map-marker-alt"></i> Google Maps</a>
              </div>
            </div>

            <!-- Resepsi -->
            <div class="card-3d-wrapper reveal-on-scroll">
              <div class="glass-card event-card">
                <i class="fas fa-glass-cheers event-icon"></i>
                <h3>Resepsi</h3>
                <p style="color: var(--gold); font-weight: bold;">11:00 - 14:00 WIB</p>
                <p>Grand Hall Hotel, Yogyakarta</p>
                <a href="https://goo.gl/maps/placeholder" target="_blank" class="btn-map"><i class="fas fa-map-marker-alt"></i> Google Maps</a>
              </div>
            </div>
          </div>

          <!-- LIVE STREAMING -->
          <div class="live-btn-wrapper reveal-on-scroll">
            <p style="margin-bottom: 15px; font-style: italic;">Bagi yang berhalangan hadir, dapat menyaksikan secara live:</p>
            <a href="https://youtube.com" target="_blank" class="btn-live">
              <i class="fas fa-video"></i> Live Streaming
            </a>
          </div>
        </div>
      </section>

      <!-- AMPLOP DIGITAL -->
      <section id="gift" class="section-padding" style="background: rgba(0,0,0,0.3);">
        <div class="container text-center">
          <h2 class="reveal-on-scroll" style="font-size: 2.5rem;">Walimahan & Gift</h2>
          <p class="reveal-on-scroll" style="color: var(--text-muted); margin-bottom: 30px;">Doa restu Anda merupakan karunia yang sangat berarti bagi kami. Dan jika memberi adalah ungkapan tanda kasih Anda, Anda dapat memberi kado secara cashless.</p>
          
          <div class="gift-card reveal-on-scroll">
            <div class="bank-name">BCA</div>
            <div class="rekening">123 456 7890</div>
            <p style="margin-bottom: 20px;">a.n Fulan bin Fulan</p>
            <button class="btn-copy" onclick="copyToClipboard('1234567890')">
              <i class="far fa-copy"></i> Salin Nomor Rekening
            </button>
          </div>
        </div>
      </section>

      <!-- RSVP & GUESTBOOK -->
      <section id="rsvp" class="section-padding">
        <div class="container">
          <h2 class="text-center reveal-on-scroll" style="font-size: 2.5rem; margin-bottom: 40px;">RSVP & Ucapan</h2>
          
          <div class="rsvp-form glass-card reveal-on-scroll">
            <!-- Form RSVP -->
            <div id="rsvp-form">
              <div class="form-group">
                <label class="form-label">Nama Lengkap</label>
                <input type="text" id="nama" class="form-input" placeholder="Nama Anda" required>
              </div>
              
              <div class="form-group">
                <label class="form-label">Konfirmasi Kehadiran</label>
                <select id="hadir" class="form-select">
                  <option value="Hadir">Hadir</option>
                  <option value="Tidak Hadir">Tidak Hadir</option>
                  <option value="Ragu">Masih Ragu</option>
                </select>
              </div>

              <!-- INPUT ALAMAT SESUAI REQUEST -->
              <div class="form-group">
                <label class="form-label">Alamat Domisili</label>
                <input type="text" id="alamat" class="form-input" placeholder="Contoh: Jakarta Selatan" required>
              </div>

              <div class="form-group">
                <label class="form-label">Ucapan & Doa</label>
                <textarea id="pesan" class="form-textarea" rows="3" placeholder="Tulis ucapan..." required></textarea>
              </div>

              <button class="btn-submit" onclick="kirimRSVP()">Kirim Konfirmasi</button>
            </div>

            <!-- Sukses State -->
            <div id="rsvp-success" class="hidden text-center">
              <i class="fas fa-check-circle" style="font-size: 3rem; color: var(--gold); margin-bottom: 15px;"></i>
              <h3>Terima Kasih!</h3>
              <p>Konfirmasi kehadiran Anda telah kami terima.</p>
              <div id="qr-ticket" style="margin-top: 20px;"></div>
              <button class="btn-submit" onclick="resetRSVP()" style="margin-top: 20px;">Isi Ulang</button>
            </div>
          </div>
        </div>
      </section>
    </main>

    <footer>
      <p class="font-script" style="font-size: 2rem; color: var(--gold);">Fulan & Fulanah</p>
      <p>&copy; 2026 Wedding Invitation. Barakallahu lakuma.</p>
    </footer>

    <script>
      // --- URL GOOGLE APPS SCRIPT ANDA ---
      // Pastikan spreadsheet memiliki header: Nama, Kehadiran, Pesan, Alamat, Token
      const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz9kROyde8G2F-JKsW4M80K9kKo_ov0uASdkHQlHqpBlxPqKYiugzsuJPbqhXip30MJpQ/exec";

      // --- OPEN INVITATION & PLAY MUSIC ---
      function openInvitation() {
        const overlay = document.getElementById('cover-overlay');
        const main = document.getElementById('main-content');
        const audio = document.getElementById('bg-music');
        const musicBtn = document.getElementById('music-btn');

        overlay.classList.add("opened");
        main.style.display = "block";
        document.body.style.overflowY = "auto";

        // Play Music
        audio.play().then(() => {
          musicBtn.classList.add('playing');
        }).catch(error => {
          console.log("Autoplay dicegah browser, silakan klik tombol musik manual.");
        });

        window.scrollTo(0, 0);
        setTimeout(() => { revealElements(); }, 500);
      }

      // --- MUSIC CONTROL ---
      function toggleMusic() {
        const audio = document.getElementById('bg-music');
        const btn = document.getElementById('music-btn');
        if (audio.paused) {
          audio.play();
          btn.classList.add('playing');
        } else {
          audio.pause();
          btn.classList.remove('playing');
        }
      }

      // --- SCROLL REVEAL ---
      function revealElements() {
        const reveals = document.querySelectorAll(".reveal-on-scroll");
        const windowHeight = window.innerHeight;
        const elementVisible = 150;
        reveals.forEach((reveal) => {
          const elementTop = reveal.getBoundingClientRect().top;
          if (elementTop < windowHeight - elementVisible) {
            reveal.style.opacity = "1";
            reveal.style.transform = "translateY(0)";
          }
        });
      }
      document.querySelectorAll(".reveal-on-scroll").forEach(el => {
        el.style.opacity = "0";
        el.style.transform = "translateY(50px)";
        el.style.transition = "all 1s ease-out";
      });
      window.addEventListener("scroll", revealElements);

      // --- RSVP LOGIC (SESUAI KOLOM SPREADSHEET) ---
      function kirimRSVP() {
        const nama = document.getElementById('nama');
        const hadir = document.getElementById('hadir');
        const alamat = document.getElementById('alamat'); // Kolom Alamat
        const pesan = document.getElementById('pesan');
        const btn = document.querySelector('.btn-submit');

        if (!nama.value || !pesan.value || !alamat.value) {
          alert("Mohon lengkapi Nama, Alamat, dan Ucapan.");
          return;
        }

        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Mengirim...';
        btn.disabled = true;

        // Buat Token Unik untuk QR
        let t = localStorage.getItem("token");
        if (!t) {
          t = "TAMU-" + Date.now().toString(36) + Math.random().toString(36).substr(2);
          localStorage.setItem("token", t);
        }

        // Siapkan Data untuk Spreadsheet
        // Pastikan key (kiri) cocok dengan yang dibaca oleh Apps Script Anda
        const params = new URLSearchParams();
        params.append("nama", nama.value);        // Kolom: Nama
        params.append("hadir", hadir.value);      // Kolom: Kehadiran
        params.append("pesan", pesan.value);      // Kolom: Pesan
        params.append("alamat", alamat.value);    // Kolom: Alamat
        params.append("token", t);                // Kolom: Token

        fetch(SCRIPT_URL, { method: "POST", body: params, mode: "no-cors" })
          .then(() => {
            setTimeout(() => {
              document.getElementById('rsvp-form').classList.add('hidden');
              document.getElementById('rsvp-success').classList.remove('hidden');
              
              // Generate QR Code dari Token
              const qrDiv = document.getElementById('qr-ticket');
              qrDiv.innerHTML = "";
              new QRCode(qrDiv, { 
                text: t, 
                width: 150, 
                height: 150,
                colorDark : "#000000",
                colorLight : "#ffffff"
              });
            }, 1000);
          })
          .catch(err => {
            alert("Gagal mengirim data: " + err);
            btn.innerHTML = "Kirim Konfirmasi";
            btn.disabled = false;
          });
      }

      function resetRSVP() {
        document.getElementById('rsvp-form').classList.remove('hidden');
        document.getElementById('rsvp-success').classList.add('hidden');
        document.getElementById('nama').value = "";
        document.getElementById('alamat').value = "";
        document.getElementById('pesan').value = "";
        document.querySelector('.btn-submit').innerHTML = "Kirim Konfirmasi";
        document.querySelector('.btn-submit').disabled = false;
      }

      // --- COPY TO CLIPBOARD ---
      function copyToClipboard(text) {
        navigator.clipboard.writeText(text).then(() => {
          alert("Nomor Rekening Berhasil Disalin!");
        });
      }
    </script>
  </body>
</html>
