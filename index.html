<!DOCTYPE html>
<html lang="jv">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Wedding of Fulan & Fulanah</title>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Poppins:wght@300;400;500&display=swap"
      rel="stylesheet"
    />

    <!-- QR Code Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
      /* --- RESET & VARIABLES --- */
      :root {
        --gold: #d4af6a;
        --gold-light: #f9e4b0;
        --gold-dark: #aa8c4b;
        --dark-bg: #0b0908;
        --glass-bg: rgba(20, 18, 16, 0.7);
        --glass-border: rgba(212, 175, 106, 0.2);
        --text-main: #f5f2eb;
        --text-muted: #a89f91;
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      body {
        background: radial-gradient(circle at center, #1a1512 0%, #0b0908 100%);
        color: var(--text-main);
        font-family: "Poppins", sans-serif;
        min-height: 100vh;
        overflow-x: hidden;
        display: flex;
        justify-content: center;
        align-items: center;
        perspective: 1000px; /* Untuk efek 3D */
      }

      /* --- BACKGROUND PARTICLES --- */
      #particle-canvas {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: -1;
        pointer-events: none;
      }

      /* --- MAIN CONTAINER (GLASS CARD) --- */
      .main-card {
        width: 100%;
        max-width: 480px;
        margin: 20px;
        padding: 40px 30px;
        background: var(--glass-bg);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        border: 1px solid var(--glass-border);
        border-radius: 20px;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5),
          0 0 0 1px rgba(255, 255, 255, 0.05) inset;
        text-align: center;
        transform-style: preserve-3d;
        transition: transform 0.1s ease-out;
        position: relative;
        overflow: hidden;
      }

      /* Decorative line */
      .main-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        width: 60px;
        height: 3px;
        background: linear-gradient(
          90deg,
          transparent,
          var(--gold),
          transparent
        );
      }

      /* --- TYPOGRAPHY --- */
      h1,
      h2,
      h3 {
        font-family: "Playfair Display", serif;
        color: var(--gold);
        margin-bottom: 0.5rem;
      }

      h1 {
        font-size: 2.8rem;
        font-weight: 700;
        background: linear-gradient(
          to right,
          var(--gold-light),
          var(--gold),
          var(--gold-light)
        );
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent; /* Text gradient effect */
        text-shadow: 0 4px 10px rgba(212, 175, 106, 0.1);
        margin-bottom: 10px;
        letter-spacing: -1px;
      }

      .subtitle {
        font-family: "Cormorant Garamond", serif;
        font-size: 1.4rem;
        color: var(--text-main);
        letter-spacing: 2px;
        text-transform: uppercase;
        margin-bottom: 30px;
        font-style: italic;
      }

      .section-title {
        font-size: 1.2rem;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 3px;
        margin-bottom: 20px;
        border-bottom: 1px solid var(--glass-border);
        display: inline-block;
        padding-bottom: 5px;
      }

      /* --- FORM ELEMENTS --- */
      .form-group {
        margin-bottom: 20px;
        text-align: left;
      }

      label {
        font-family: "Cormorant Garamond", serif;
        font-size: 1.1rem;
        color: var(--gold-light);
        margin-bottom: 8px;
        display: block;
      }

      input,
      select,
      textarea {
        width: 100%;
        padding: 12px 15px;
        background: rgba(0, 0, 0, 0.3);
        border: 1px solid #333;
        border-radius: 8px;
        color: #fff;
        font-family: "Poppins", sans-serif;
        font-size: 0.95rem;
        transition: all 0.3s ease;
        outline: none;
      }

      input:focus,
      select:focus,
      textarea:focus {
        border-color: var(--gold);
        box-shadow: 0 0 15px rgba(212, 175, 106, 0.15);
        background: rgba(0, 0, 0, 0.5);
      }

      /* Placeholder styling */
      ::placeholder {
        color: #666;
        font-style: italic;
      }

      /* --- BUTTON --- */
      .btn-submit {
        width: 100%;
        padding: 14px;
        margin-top: 10px;
        background: linear-gradient(45deg, var(--gold-dark), var(--gold));
        border: none;
        border-radius: 8px;
        color: #1a1512;
        font-weight: 600;
        font-family: "Poppins", sans-serif;
        letter-spacing: 1px;
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        text-transform: uppercase;
        font-size: 0.9rem;
        position: relative;
        overflow: hidden;
      }

      .btn-submit:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 20px rgba(212, 175, 106, 0.3);
        background: linear-gradient(45deg, var(--gold), var(--gold-light));
      }

      .btn-submit:active {
        transform: translateY(1px);
      }

      /* --- QR SECTION --- */
      #qr-section {
        margin-top: 40px;
        padding-top: 30px;
        border-top: 1px dashed var(--glass-border);
        display: none; /* Hidden by default */
        opacity: 0;
        transition: opacity 0.8s ease;
      }

      #qr-section.visible {
        display: block;
        opacity: 1;
        animation: slideUp 0.8s ease forwards;
      }

      #qrcode {
        background: #fff;
        padding: 15px;
        border-radius: 10px;
        display: inline-block;
        margin-top: 15px;
        box-shadow: 0 0 20px rgba(212, 175, 106, 0.2);
      }

      #qrcode img {
        display: block; /* Remove extra space */
      }

      .qr-caption {
        font-size: 0.85rem;
        color: var(--text-muted);
        margin-top: 10px;
        line-height: 1.5;
      }

      /* --- TOAST NOTIFICATION --- */
      #toast {
        visibility: hidden;
        min-width: 250px;
        background-color: var(--gold);
        color: #1a1512;
        text-align: center;
        border-radius: 50px;
        padding: 16px;
        position: fixed;
        z-index: 100;
        left: 50%;
        bottom: 30px;
        transform: translateX(-50%);
        font-weight: 500;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
        opacity: 0;
        transition: opacity 0.3s, bottom 0.3s;
      }

      #toast.show {
        visibility: visible;
        opacity: 1;
        bottom: 50px;
      }

      /* --- ANIMATIONS --- */
      @keyframes slideUp {
        from {
          transform: translateY(20px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .fade-in {
        animation: fadeIn 1.5s ease-out forwards;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Responsive */
      @media (max-width: 480px) {
        h1 {
          font-size: 2.2rem;
        }
        .main-card {
          margin: 0;
          width: 100%;
          height: 100vh;
          border-radius: 0;
          border: none;
          display: flex;
          flex-direction: column;
          justify-content: center;
        }
      }
    </style>
  </head>

  <body>
    <!-- Canvas Background untuk Efek Partikel 3D -->
    <canvas id="particle-canvas"></canvas>

    <!-- Container Utama -->
    <div class="main-card" id="tilt-card">
      <!-- Header -->
      <header class="fade-in" style="margin-bottom: 40px">
        <p
          style="
            font-family: 'Cormorant Garamond';
            letter-spacing: 4px;
            color: var(--gold);
            font-size: 0.9rem;
          "
        >
          THE WEDDING OF
        </p>
        <h1>Fulan & Fulanah</h1>
        <p class="subtitle">23 Mei 2026 ‚Ä¢ Solo</p>
      </header>

      <!-- Form RSVP -->
      <section class="fade-in" style="animation-delay: 0.3s">
        <div class="section-title">Konfirmasi Kehadiran</div>

        <div class="card-content">
          <div class="form-group">
            <label for="nama">Asma Panjenengan</label>
            <input
              type="text"
              id="nama"
              placeholder="Mangga tulis asma..."
              autocomplete="off"
            />
          </div>

          <div class="form-group">
            <label for="hadir">Kepingin Rawuh?</label>
            <select id="hadir">
              <option value="Hadir">Inggih, badhe rawuh</option>
              <option value="Tidak Hadir">Mboten saged rawuh</option>
            </select>
          </div>

          <div class="form-group">
            <label for="pesan">Ucapan & Pangestu</label>
            <textarea
              id="pesan"
              rows="3"
              placeholder="Tulis pangestu kangg√© penganten..."
            ></textarea>
          </div>

          <button class="btn-submit" onclick="submitRSVP()">
            Kirim Konfirmasi
          </button>
        </div>
      </section>

      <!-- QR Code Section (Reveal) -->
      <section id="qr-section">
        <div class="section-title">Tiket Digital</div>
        <p class="qr-caption">
          Mangga tampilaken QR Code meniku nalikanipun rawuh ing papan resepsi.
        </p>
        <div id="qrcode"></div>
      </section>
    </div>

    <!-- Toast Notification -->
    <div id="toast">Matur nuwun saget dipun panjurungi üôè</div>

    <script>
      /* --- 1. LOGIC DATA & RSVP --- */
      const SHEET_URL =
        "https://script.google.com/macros/s/AKfycbzJsKL1O01UuV6d9OaZDUt0sZ0SkRzTXFxOmqBNKSA_fEbi6Ys-RUy3A3OFpbJdsDkr/exec";

      function generateToken() {
        return (
          "TAMU-" +
          Date.now() +
          "-" +
          Math.random().toString(36).substr(2, 6).toUpperCase()
        );
      }

      function tampilkanQR(token) {
        const container = document.getElementById("qr-section");
        const box = document.getElementById("qrcode");

        box.innerHTML = ""; // Clear previous

        new QRCode(box, {
          text: token,
          width: 160,
          height: 160,
          colorDark: "#0b0908",
          colorLight: "#ffffff",
          correctLevel: QRCode.CorrectLevel.H,
        });

        container.classList.add("visible");

        // Smooth scroll to QR
        setTimeout(() => {
          container.scrollIntoView({ behavior: "smooth", block: "nearest" });
        }, 100);
      }

      function showToast(message) {
        const toast = document.getElementById("toast");
        toast.textContent = message;
        toast.className = "show";
        setTimeout(() => {
          toast.className = toast.className.replace("show", "");
        }, 3000);
      }

      function submitRSVP() {
        const nama = document.getElementById("nama").value.trim();
        const hadir = document.getElementById("hadir").value;
        const pesan = document.getElementById("pesan").value;
        const btn = document.querySelector(".btn-submit");

        if (!nama) {
          showToast("Mangga dipun wontenaken asma panjenengan");
          document.getElementById("nama").focus();
          return;
        }

        // Loading state
        const originalText = btn.innerText;
        btn.innerText = "Ngirim...";
        btn.style.opacity = "0.7";
        btn.disabled = true;

        let token = localStorage.getItem("qr_token_wedding");
        if (!token) {
          token = generateToken();
          localStorage.setItem("qr_token_wedding", token);
        }

        // Send Data (Mock Fetch logic as per original)
        fetch(SHEET_URL, {
          method: "POST",
          mode: "no-cors",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ mode: "rsvp", nama, hadir, pesan, token }),
        })
          .then(() => {
            tampilkanQR(token);
            showToast("Matur nuwun! RSVP sampun katerima.");
          })
          .catch((err) => {
            console.error(err);
            tampilkanQR(token); // Fallback to show QR even if fetch fails
            showToast("Kiriman saged, nanging koneksi boten sae.");
          })
          .finally(() => {
            btn.innerText = "Sampun Kirim";
            btn.style.background = "#2c2c2c"; // Darken button
            btn.style.color = "#fff";
          });
      }

      // Auto Load QR on Refresh if exists
      window.onload = () => {
        const token = localStorage.getItem("qr_token_wedding");
        if (token) {
          tampilkanQR(token);
        }
        initParticles();
      };

      /* --- 2. 3D TILT EFFECT LOGIC --- */
      const card = document.getElementById("tilt-card");

      // Hanya jalankan efek tilt di desktop (mouse), di mobile disable agar tidak berat
      if (window.matchMedia("(min-width: 768px)").matches) {
        document.addEventListener("mousemove", (e) => {
          const x = (window.innerWidth / 2 - e.pageX) / 50; // rotation speed
          const y = (window.innerHeight / 2 - e.pageY) / 50;

          // Batasi rotasi agar tidak berlebihan
          const clampX = Math.max(-5, Math.min(5, x));
          const clampY = Math.max(-5, Math.min(5, y));

          card.style.transform = `rotateY(${clampX}deg) rotateX(${-clampY}deg)`;
        });
      }

      /* --- 3. BACKGROUND PARTICLES (CANVAS) --- */
      function initParticles() {
        const canvas = document.getElementById("particle-canvas");
        const ctx = canvas.getContext("2d");
        let particles = [];

        function resize() {
          canvas.width = window.innerWidth;
          canvas.height = window.innerHeight;
        }
        window.addEventListener("resize", resize);
        resize();

        class Particle {
          constructor() {
            this.x = Math.random() * canvas.width;
            this.y = Math.random() * canvas.height;
            this.size = Math.random() * 2;
            this.speedX = Math.random() * 0.5 - 0.25;
            this.speedY = Math.random() * 0.5 - 0.25;
            this.color = `rgba(212, 175, 106, ${Math.random() * 0.5})`; // Gold color with opacity
          }
          update() {
            this.x += this.speedX;
            this.y += this.speedY;
            if (this.x > canvas.width) this.x = 0;
            if (this.x < 0) this.x = canvas.width;
            if (this.y > canvas.height) this.y = 0;
            if (this.y < 0) this.y = canvas.height;
          }
          draw() {
            ctx.fillStyle = this.color;
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            ctx.fill();
          }
        }

        for (let i = 0; i < 100; i++) particles.push(new Particle());

        function animate() {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          for (let i = 0; i < particles.length; i++) {
            particles[i].update();
            particles[i].draw();
          }
          requestAnimationFrame(animate);
        }
        animate();
      }
    </script>
  </body>
</html>
